# Обновление формы создания заявок

## Дата: 2026-01-16

## Описание изменений

Обновлена форма создания заявок для улучшения UX/UI и интеграции с системой пользователей.

### Основные изменения:

#### 1. **Выбор ответственного из списка**
- ✅ Заменено поле ввода ID на выпадающий список (`<select>`)
- ✅ Автоматическая загрузка всех пользователей системы
- ✅ Отображение имени и роли пользователя в списке
- ✅ Исключение текущего пользователя из списка (нельзя назначить заявку самому себе)

**Пример отображения:**
```
Выберите пользователя
Иванов Иван (МП)
Петрова Мария (МРиЗ)
Сидоров Петр (БА)
```

#### 2. **Визуальное представление пользователей**
- ✅ Добавлены цветные аватары с инициалами
- ✅ Отображение роли пользователя с цветовой индикацией
- ✅ Улучшенный дизайн карточек с информацией о пользователях

**Цветовая схема ролей:**
- МП: `#42A5F5` (синий)
- МРиЗ: `#66BB6A` (зеленый)
- БА: `#FFA726` (оранжевый)
- Администратор: `#9C27B0` (фиолетовый)

#### 3. **Оптимизация производительности**
- ✅ Список пользователей загружается один раз при инициализации компонента
- ✅ Разделены `useEffect` для загрузки пользователей и заявок
- ✅ Уменьшено количество API запросов

### Технические детали:

#### Новые функции:
```typescript
// Загрузка пользователей из API
const loadUsers = async () => {
    const data = await authService.getUsers();
    setUsers(data);
}

// Получение цвета роли
const getRoleColor = (role?: string): string => {
    const colors: Record<string, string> = {
        'МП': '#42A5F5',
        'МРиЗ': '#66BB6A',
        'БА': '#FFA726',
        'Администратор': '#9C27B0'
    };
    return colors[role || ''] || '#999';
}
```

#### Новые CSS классы:
```css
.user-avatar-sm         /* Круглый аватар с инициалом */
.user-role-badge        /* Бейдж с ролью пользователя */
.meta-item.user-info    /* Контейнер для информации о пользователе */
```

### Изменённые файлы:

1. **`frontend-react/src/pages/Requests.tsx`**
   - Добавлен импорт `authService`
   - Добавлено состояние `users`
   - Добавлена функция `loadUsers()`
   - Добавлена функция `getRoleColor()`
   - Обновлена форма создания заявки (select вместо input)
   - Улучшено отображение пользователей в карточках заявок

2. **`frontend-react/src/pages/Requests.css`**
   - Добавлены стили для `.user-avatar-sm`
   - Добавлены стили для `.user-role-badge`
   - Обновлены стили для `.meta-item`

### API зависимости:

- `GET /api/auth/users` - получение списка всех пользователей
- Используется существующий `authService.getUsers()`

### Преимущества:

✅ **Улучшенный UX:**
- Пользователь видит список доступных исполнителей
- Невозможно ошибиться с ID пользователя
- Наглядное отображение ролей

✅ **Соответствие дизайн-системе:**
- Используется единая цветовая схема ролей
- Консистентный дизайн с другими страницами портала
- Применены фирменные стили Inter и золотой акцент

✅ **Производительность:**
- Минимизированы API запросы
- Оптимизированная загрузка данных

### Скриншоты:

**Форма создания заявки (до):**
```
Ответственный *
[Введите ID пользователя...]  <- Неудобно
```

**Форма создания заявки (после):**
```
Ответственный *
[Выберите пользователя ▼]
  Иванов Иван (МП)
  Петрова Мария (МРиЗ)
  Сидоров Петр (БА)
```

**Карточка заявки (с аватарами):**
```
┌─────────────────────────────────────┐
│ От: [И] Иванов Иван МП              │
│ Ответственный: [П] Петрова М. МРиЗ  │
│ Создана: 16.01.2026, 14:50          │
└─────────────────────────────────────┘
```

### Будущие улучшения:

- [ ] Добавить поиск по пользователям в select
- [ ] Добавить группировку по ролям
- [ ] Показывать статус пользователя (онлайн/офлайн)
- [ ] Добавить возможность назначения нескольких ответственных
